## 정의

> **프로미스 체이닝(Promise Chaining)**: 프로미스 후속 처리 메서드들이 프로미스를 반환하기 떄문에, 연속적으로 호출할 수 있는 패턴.

Promise는 .then(), .catch(), .finally()와 같은 후속 처리메서드를 통해서 체이닝을 할 수 있고,이는 언제나 프로미스를 반환하므로 연속적으로 호출할 수 있다. 이를 프로미스 체이닝(promise chaining)이라고 한다.

## 기본 패턴

```javascript
const promise = new Promise((resolve, reject) => resolve()});

promise
	.then(() => {})
	.catch(() => {})
	.finally(() => {})
```

## 후속 처리 방식
### finally 여러 번 호출

> `finally`는 체인에 등장할 때마다 **항상 호출된다.**
> 다만 `finally` 내부에서 반환한 값은 무시되고, 이전 프로미스의 결과가 그대로 다음 체인으로 전달된다.

```javascript
const url = "https://jsonplaceholder.typicode.com/todos";

const fetchTodos = fetch(url);

fetchTodos
  .then((response) => response.json())
  .finally(() => console.log("finally"))
  .finally(() => console.log("finally 2"));

/*
[실행결과]
finally
finally 2
*/
```

### finally 이후에 then
> `finally`는 `then`이나 `catch`가 끝난 뒤 호출된다.
> 하지만 `finally`자체가 값을 바꾸지 않으므로, 이후 `then`에서는 원래의 resolve 결과가 그대로 전달된다.
> 즉, 체인에서의 순서는: `then -> finally -> then`
> ( `finally`는 중간에 끼지만 **결과 흐름에는 간섭하지 않는다.** )

```javascript
const url = "https://jsonplaceholder.typicode.com/todos";

const fetchTodos = fetch(url);

fetchTodos
  .then((response) => response.json())
  .then((json) => {
    console.log(json[1]);
    return json;
  })
  .finally(() => console.log("finally"))
  .finally(() => console.log("finally 2"))
  .then((json) => console.log(json[0]));
/*
[실행결과]
{
  userId: 1,
  id: 2,
  title: 'quis ut nam facilis et officia qui',
  completed: false
}
finally
finally 2
{ userId: 1, id: 1, title: 'delectus aut autem', completed: false }
*/


```